# Проект со встроенным парсером книжных сайтов

Проект написан с использованием фрейморвка Django и автоматически парсит каталоги Читай-города, Лабиринта и Book24. <br> В админ-зоне запускается парсер отдельно для каждого каталога и там же отслеживается состояние потоков

## Инструкция по запуску

Первый запуск рекомендую выполнить вне докера, либо проводить миграции и создавть юзера для админки нужно будет из консоли контейнера

### 1) создать .env файл

Оттуда проект берет данные для подключения к БД. Сейчас проект настроен на подключение к Postgres. При необходимости изменить настройки согласна документации Django <br>
Содержимое файла .env
```
DB_NAME= #имя таблицы 
DB_USER= #имя пользователя для подключения
DB_PASSWORD= #пароль от пользователя
DB_HOST= #адрес БД. Если проект запускается вне контейнера localhost, есди в контейнере - имя контейнера вашей БД
DB_PORT= #порт подключения
``` 

### 2) провести миграцию

Если выполняется запуск вне контейнера необхзодимо установить дополнительные модули. При запуске контейнера это не требуется
```
python -m venv venv
source /venv/bin/activate
pip install -r requirements.txt
```
Далее проведение миграции
```
cd bookparser
python manage.py makemigrations
python manage.py migrate
```

### 3) создать админа

Под этим пользователем будет выполняться вход в админ зону
```
python manage.py createsuperuser
```

### 4*) Если запуск производиться вне контейнера

Проверить, что все работает корректно
```
python manage.py runserver
```

### 5) Создание сети для контейнеров

Контейнеры должны находиться в одной docker-сети, чтобы Django смог подключиться к Postgres
```
docker network create <network-name>
```
Также сразу подключить контейнер с Postgres в новую сеть
```
docker network connect <network-name> <postgres-container>
```
### 6) Создание образа и запуск контейнера

Сперва необходимо собрать образ. При любом изменении файлов необходимо будет произведсти повторную сборку, удалить старый контейнер и поднять новый.
```
docker build -t django-bookparser
```
Далее сразу создаем контейнер на основе собранного образа
```
 docker run --name django-bookparser \ #имя для контейнера
            --network <network-name> \ #подключение в docker-сеть
             -p 8000:8000 \ # связка внешнекго порта
             django-bookparser # наименование образа
```
Dockerfile был взять с официального манула по Django от Docker, при желании можно изменить значения